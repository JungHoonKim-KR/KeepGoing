<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="keepgoing.demo.domain.diet.mapper.FoodMapper">

    <resultMap id="FoodResultMap" type="keepgoing.demo.domain.diet.entity.Food" autoMapping="true">
        <id property="code" column="code"/>

    </resultMap>
    <!-- 전체 목록 조회 (SELECT ALL) -->
    <select id="selectAll" resultMap="FoodResultMap">
        SELECT *
        FROM food LIMIT 10
    </select>
    <!-- 단일 레코드 조회 (SELECT BY NAME) -->
    <select id="selectByName" resultMap="FoodResultMap">
        SELECT *
        FROM food
        WHERE name LIKE CONCAT('%', #{name}, '%')
        ORDER BY CASE
                     WHEN name = #{name} THEN 1
                     WHEN name LIKE CONCAT(#{name}, '%') THEN 2
                     ELSE 3 END,
                 name ASC  </select>
    <select id="selectByExactName" resultMap="FoodResultMap">
        SELECT *
        FROM food
        WHERE name = #{foodName}
        LIMIT 1
    </select>

    <insert id="save" parameterType="keepgoing.demo.domain.diet.entity.Food">
        INSERT INTO food (
            code,
            name,
            dataTypeName,
            middleCategoryName,
            foodWeight,
            servingSize,
            energy,
            water,
            protein,
            fat,
            carbohydrate,
            sugars,
            sodium
        ) VALUES (
                     #{code},
                     #{name},
                     #{dataTypeName},
                     #{middleCategoryName},
                     #{foodWeight},
                     #{servingSize},
                     #{energy},
                     #{water},
                     #{protein},
                     #{fat},
                     #{carbohydrate},
                     #{sugars},
                     #{sodium}
                 )
    </insert>
</mapper>